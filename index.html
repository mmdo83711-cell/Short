<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>URL ‡¶∂‡¶∞‡ßç‡¶ü‡¶®‡¶æ‡¶∞ - ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶≤‡¶ø</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; justify-content: center; align-items: flex-start; padding: 10px; }
        .app-container { width: 100%; max-width: 500px; background: white; border-radius: 25px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; margin: 10px 0; }
        .app-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px 20px 30px 20px; color: white; }
        .app-title { font-size: 1.6em; font-weight: 700; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }
        .app-subtitle { font-size: 0.9em; opacity: 0.9; margin-bottom: 15px; }
        .nav-tabs { display: flex; gap: 10px; margin-top: 15px; }
        .nav-tab { flex: 1; padding: 12px 0; background: rgba(255,255,255,0.2); border: none; border-radius: 15px; color: white; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s; backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; gap: 6px; }
        .nav-tab.active { background: white; color: #667eea; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .content-area { padding: 25px 20px; background: white; }
        .stats-summary { display: flex; justify-content: space-around; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 20px; padding: 15px; margin-bottom: 25px; }
        .stat-box { text-align: center; }
        .stat-number { font-size: 1.8em; font-weight: 700; color: #667eea; line-height: 1.2; }
        .stat-text { color: #666; font-size: 0.8em; text-transform: uppercase; letter-spacing: 0.5px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #555; font-weight: 600; font-size: 0.9em; }
        input { width: 100%; padding: 16px 18px; border: 2px solid #e0e0e0; border-radius: 15px; font-size: 16px; transition: all 0.3s; background: #f8f9fa; -webkit-appearance: none; }
        input:focus { outline: none; border-color: #667eea; background: white; box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1); }
        .custom-slug { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .base-url { background: #e9ecef; padding: 16px 18px; border-radius: 15px; color: #495057; font-size: 0.8em; font-weight: 500; white-space: nowrap; overflow: hidden; max-width: 120px; text-overflow: ellipsis; }
        .custom-slug input { flex: 1; min-width: 150px; }
        .btn { width: 100%; padding: 18px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 15px; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; margin-bottom: 20px; position: relative; overflow: hidden; }
        .btn:active { transform: scale(0.98); }
        .ad-notice { background: #fff3cd; border: 2px solid #ffeeba; border-radius: 12px; padding: 12px 15px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; font-size: 0.9em; color: #856404; }
        .ad-counter { background: #ffc107; color: #333; padding: 3px 10px; border-radius: 20px; font-weight: 600; margin-left: auto; }
        .result { background: #f8f9fa; border-radius: 20px; padding: 20px; margin-top: 20px; border: 2px solid #e0e0e0; }
        .result h3 { color: #333; margin-bottom: 15px; font-size: 1.1em; display: flex; align-items: center; gap: 5px; }
        .short-url-container { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
        .short-url { flex: 1; min-width: 200px; padding: 15px; background: white; border: 2px solid #e0e0e0; border-radius: 12px; color: #667eea; font-weight: 500; word-break: break-all; font-size: 0.95em; }
        .copy-btn { padding: 15px 25px; background: #28a745; color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1em; white-space: nowrap; }
        .recent-urls { margin-top: 25px; }
        .url-list { max-height: 400px; overflow-y: auto; border-radius: 15px; background: #f8f9fa; border: 2px solid #e0e0e0; }
        .url-item { padding: 15px; border-bottom: 1px solid #e0e0e0; cursor: pointer; transition: background 0.2s; }
        .url-item:last-child { border-bottom: none; }
        .url-info { margin-bottom: 10px; }
        .url-original { font-size: 0.85em; color: #666; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .url-short { color: #667eea; font-weight: 600; font-size: 1em; margin-bottom: 5px; word-break: break-all; }
        .url-meta { display: flex; gap: 15px; font-size: 0.75em; color: #999; }
        .url-actions { display: flex; gap: 8px; margin-top: 10px; }
        .url-action-btn { flex: 1; padding: 12px; border: none; border-radius: 10px; font-weight: 600; font-size: 0.9em; cursor: pointer; }
        .copy-small { background: #28a745; color: white; }
        .delete-small { background: #dc3545; color: white; }
        .detail-card { background: #f8f9fa; border-radius: 20px; padding: 20px; margin-bottom: 20px; border: 2px solid #e0e0e0; }
        .detail-row { margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e0e0e0; }
        .detail-value { color: #333; font-weight: 600; font-size: 1.1em; word-break: break-all; }
        .back-btn { display: flex; align-items: center; gap: 5px; padding: 12px 20px; background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 12px; color: #667eea; font-weight: 600; cursor: pointer; margin-bottom: 20px; width: fit-content; }
        .error-message { color: #dc3545; font-size: 0.9em; margin-top: 5px; padding: 10px; background: #f8d7da; border-radius: 10px; display: none; }
        .error-message.show { display: block; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hidden { display: none; }
        /* ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® */
        .redirect-notice { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 12px 24px; border-radius: 50px; font-size: 0.9em; z-index: 1000; box-shadow: 0 5px 20px rgba(0,0,0,0.3); display: none; }
    </style>
</head>
<body>
    <!-- ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® -->
    <div class="redirect-notice" id="redirectNotice">
        ‚è≥ ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...
    </div>

    <div class="app-container">
        <div class="app-header">
            <div class="app-title"><span>üîó</span> URL ‡¶∂‡¶∞‡ßç‡¶ü‡¶®‡¶æ‡¶∞</div>
            <div class="app-subtitle">‡¶≤‡¶Æ‡ßç‡¶¨‡¶æ URL ‡¶õ‡ßã‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶∏‡¶π‡¶ú‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
            <div class="nav-tabs">
                <button class="nav-tab active" id="homeTab" onclick="switchTab('home')"><span>üè†</span> Home</button>
                <button class="nav-tab" id="urlTab" onclick="switchTab('urls')"><span>üîó</span> URL</button>
            </div>
        </div>

        <div id="homeContent" class="content-area">
            <div class="stats-summary">
                <div class="stat-box">
                    <div class="stat-number" id="totalUrls">0</div>
                    <div class="stat-text">‡¶Æ‡ßã‡¶ü URL</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="totalClicks">0</div>
                    <div class="stat-text">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï</div>
                </div>
            </div>

            <div class="ad-notice">
                <span>üì¢</span>
                <span>‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ URL ‡¶∂‡¶∞‡ßç‡¶ü ‡¶π‡¶¨‡ßá</span>
                <span class="ad-counter" id="adCounter">1/2</span>
            </div>

            <div class="input-group">
                <label for="longUrl">üîó ‡¶≤‡¶Ç URL</label>
                <input type="url" id="longUrl" placeholder="https://example.com" inputmode="url">
            </div>

            <div class="input-group">
                <label for="customSlug">‚úèÔ∏è ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶∏‡ßç‡¶≤‡¶æ‡¶ó (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label>
                <div class="custom-slug">
                    <!-- Base URL ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶¨‡ßá -->
                    <span class="base-url" id="displayBaseUrl">loading...</span>
                    <input type="text" id="customSlug" placeholder="my-name" inputmode="text">
                </div>
            </div>

            <button class="btn" id="shortenBtn">
                <span id="btnText">‡¶∂‡¶∞‡ßç‡¶ü URL ‡¶¨‡¶æ‡¶®‡¶æ‡¶®</span>
                <span id="btnLoader" style="display: none;" class="loading"></span>
            </button>

            <div class="error-message" id="errorMessage"></div>

            <div class="result" id="result" style="display: none;">
                <h3>üéâ ‡¶∂‡¶∞‡ßç‡¶ü URL ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!</h3>
                <div class="short-url-container">
                    <input type="text" class="short-url" id="shortUrl" readonly>
                    <button class="copy-btn" id="copyBtn">‡¶ï‡¶™‡¶ø</button>
                </div>
                <div class="stats" style="display: flex; justify-content: space-between; font-size: 0.9em; color: #666;">
                    <span>üìÖ <span id="createdDate">-</span></span>
                    <span>üëÅÔ∏è <span id="clickCount">0</span> ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï</span>
                </div>
            </div>
        </div>

        <div id="urlsContent" class="content-area hidden">
            <div class="recent-urls">
                <h3>üìã ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶¨ URL</h3>
                <div class="url-list" id="urlList"></div>
            </div>
        </div>

        <div id="detailContent" class="content-area hidden">
            <div class="back-btn" onclick="showUrlsTab()"><span>‚Üê</span> ‡¶™‡¶ø‡¶õ‡¶®‡ßá</div>
            <div id="urlDetailView"></div>
        </div>

        <div class="app-footer" style="text-align: center; padding: 20px; border-top: 1px solid #eee;">
            <a href="#" class="clear-all" id="clearAll" style="color: #dc3545; text-decoration: none;">üóëÔ∏è ‡¶∏‡¶¨ URL ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</a>
        </div>
    </div>

    <script>
        // Adsterra ‡¶è‡¶° ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶∏‡¶Æ‡ßÇ‡¶π
        const AD_LINKS = [
            'https://www.effectivegatecpm.com/ek9b6x3ijv?key=c3f87b3332b54e17c0f6866a2ccfbb84',
            'https://www.effectivegatecpm.com/u48g35c7?key=a8182d67355e7a5481130df6feb71a4d',
            'https://www.effectivegatecpm.com/ch689ym0?key=0e197e3a615e2d975fc4082a906ddd33',
            'https://www.effectivegatecpm.com/up95hbv6v7?key=120544a3f30d0fce7151a07cac8a30f4'
        ];

        let adClickCount = 0;
        let lastAdIndex = -1;

        class URLShortener {
            constructor() {
                this.storageKey = 'shortened_urls_v2'; // ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶ï‡ßÄ
                
                // ‡ßß. ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶õ‡ßã‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï: index.html ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ
                let currentUrl = window.location.href.split('#')[0];
                
                // ‡¶Ø‡¶¶‡¶ø ‡¶∂‡ßá‡¶∑‡ßá index.html ‡¶¨‡¶æ index.php ‡¶•‡¶æ‡¶ï‡ßá, ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶¨
                currentUrl = currentUrl.replace(/index\.html$/, '');
                currentUrl = currentUrl.replace(/index\.php$/, '');
                
                // ‡¶∂‡ßá‡¶∑‡ßá ‡¶∏‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶¨
                if (!currentUrl.endsWith('/')) {
                    currentUrl += '/';
                }
                
                // ‡¶π‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ (#)
                this.baseUrl = currentUrl + '#';
                
                this.urls = this.loadUrls();
                this.updateStats();
                this.renderUrlList();
                
                // ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (http:// ‡¶¨‡¶æ file:// ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã)
                this.updateDisplayBaseUrl();
            }

            updateDisplayBaseUrl() {
                const cleanBase = this.baseUrl.replace(/^https?:\/\//, '').replace('file://', '');
                document.getElementById('displayBaseUrl').textContent = cleanBase;
            }

            loadUrls() {
                const stored = localStorage.getItem(this.storageKey);
                return stored ? JSON.parse(stored) : [];
            }

            saveUrls() {
                localStorage.setItem(this.storageKey, JSON.stringify(this.urls));
                this.updateStats();
                this.renderUrlList();
            }

            // ‡ß®. ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡ßã‡¶° ‡ß™ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá ‡¶®‡¶æ‡¶Æ‡¶ø‡ßü‡ßá ‡¶Ü‡¶®‡¶æ (‡¶Ü‡¶ó‡ßá ‡ß¨ ‡¶õ‡¶ø‡¶≤)
            generateShortCode(length = 4) {
                const characters = 'abcdefghijklmnopqrstuvwxyz0123456789'; // ‡¶õ‡ßã‡¶ü ‡¶π‡¶æ‡¶§‡ßá‡¶∞ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
                let result = '';
                for (let i = 0; i < length; i++) {
                    result += characters.charAt(Math.floor(Math.random() * characters.length));
                }
                return result;
            }

            isCustomSlugAvailable(slug) {
                return !this.urls.some(url => url.shortCode === slug);
            }

            validateUrl(url) {
                try {
                    new URL(url);
                    return true;
                } catch {
                    return false;
                }
            }

            addUrl(longUrl, customSlug = '') {
                // ‡¶á‡¶®‡¶™‡ßÅ‡¶ü URL ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ (http ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ)
                if (!/^https?:\/\//i.test(longUrl)) {
                    longUrl = 'http://' + longUrl;
                }

                if (!this.validateUrl(longUrl)) {
                    throw new Error('‡¶∏‡¶†‡¶ø‡¶ï URL ‡¶¶‡¶ø‡¶®');
                }

                let shortCode = customSlug;
                
                if (customSlug) {
                    if (!/^[a-zA-Z0-9_-]+$/.test(customSlug)) {
                        throw new Error('‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ');
                    }
                    if (!this.isCustomSlugAvailable(customSlug)) {
                        throw new Error('‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
                    }
                } else {
                    let attempts = 0;
                    do {
                        shortCode = this.generateShortCode();
                        attempts++;
                        if (attempts > 10) shortCode = this.generateShortCode(5);
                    } while (!this.isCustomSlugAvailable(shortCode));
                }

                const newUrl = {
                    id: Date.now(),
                    longUrl: longUrl,
                    shortCode: shortCode,
                    shortUrl: `${this.baseUrl}${shortCode}`,
                    createdAt: new Date().toISOString(),
                    clicks: 0
                };

                this.urls.unshift(newUrl);
                this.saveUrls();
                return newUrl;
            }

            deleteUrl(id) {
                this.urls = this.urls.filter(url => url.id !== id);
                this.saveUrls();
                document.getElementById('result').style.display = 'none';
                this.renderUrlList();
            }

            getUrlByShortCode(shortCode) {
                return this.urls.find(u => u.shortCode === shortCode);
            }

            updateStats() {
                document.getElementById('totalUrls').textContent = this.urls.length;
                const totalClicks = this.urls.reduce((sum, url) => sum + url.clicks, 0);
                document.getElementById('totalClicks').textContent = totalClicks;
            }

            renderUrlList() {
                const urlList = document.getElementById('urlList');
                if (this.urls.length === 0) {
                    urlList.innerHTML = '<div style="text-align:center; padding:20px; color:#999;">‡¶ï‡ßã‡¶®‡ßã URL ‡¶®‡ßá‡¶á</div>';
                    return;
                }
                urlList.innerHTML = this.urls.map(url => `
                    <div class="url-item" onclick="window.shortener.handleManualClick('${url.shortCode}')">
                        <div class="url-info">
                            <div class="url-original">${url.longUrl}</div>
                            <div class="url-short">${url.shortUrl}</div>
                            <div class="url-meta">
                                <span>üëÅÔ∏è ${url.clicks}</span>
                                <span>üìÖ ${new Date(url.createdAt).toLocaleDateString()}</span>
                            </div>
                        </div>
                        <div class="url-actions" onclick="event.stopPropagation()">
                            <button class="url-action-btn copy-small" onclick="copyUrl('${url.shortUrl}', event)">‡¶ï‡¶™‡¶ø</button>
                            <button class="url-action-btn delete-small" onclick="deleteUrl(${url.id}, event)">‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</button>
                        </div>
                    </div>
                `).join('');
            }
            
            handleManualClick(shortCode) {
                const url = this.getUrlByShortCode(shortCode);
                if (url) {
                   window.location.href = url.shortUrl;
                   window.location.reload();
                }
            }
        }

        // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
        window.shortener = null;

        function showRedirectNotice() {
            const notice = document.getElementById('redirectNotice');
            notice.style.display = 'block';
        }

        function openRandomAd() {
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * AD_LINKS.length);
            } while (randomIndex === lastAdIndex && AD_LINKS.length > 1);
            lastAdIndex = randomIndex;
            window.open(AD_LINKS[randomIndex], '_blank');
        }

        // Initialization
        window.addEventListener('load', () => {
            window.shortener = new URLShortener();
            
            // ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶ö‡ßá‡¶ï‡¶æ‡¶∞
            const hash = window.location.hash.substring(1); 
            if (hash) {
                const urlData = window.shortener.getUrlByShortCode(hash);
                if (urlData) {
                    showRedirectNotice();
                    
                    // ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                    urlData.clicks++;
                    window.shortener.saveUrls();

                    // ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü
                    setTimeout(() => {
                        window.location.href = urlData.longUrl;
                    }, 1000);
                }
            }
        });

        // UI ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡ßá‡¶ï‡¶∂‡¶®
        const longUrlInput = document.getElementById('longUrl');
        const customSlugInput = document.getElementById('customSlug');
        const shortenBtn = document.getElementById('shortenBtn');
        const errorMessage = document.getElementById('errorMessage');
        const adCounter = document.getElementById('adCounter');

        window.switchTab = function(tab) {
            document.getElementById('homeContent').classList.add('hidden');
            document.getElementById('urlsContent').classList.add('hidden');
            document.getElementById('detailContent').classList.add('hidden');
            document.getElementById('homeTab').classList.remove('active');
            document.getElementById('urlTab').classList.remove('active');

            if (tab === 'home') {
                document.getElementById('homeContent').classList.remove('hidden');
                document.getElementById('homeTab').classList.add('active');
                resetAdCounter();
            } else if (tab === 'urls') {
                document.getElementById('urlsContent').classList.remove('hidden');
                document.getElementById('urlTab').classList.add('active');
            }
        }

        function resetAdCounter() {
            adClickCount = 0;
            adCounter.textContent = "1/2";
        }

        window.copyUrl = async function(text, event) {
            if (event) event.stopPropagation();
            try {
                await navigator.clipboard.writeText(text);
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‡¶ï‡¶™‡¶ø‡¶°!';
                setTimeout(() => btn.textContent = originalText, 2000);
            } catch (err) { 
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand("copy");
                document.body.removeChild(textArea);
                alert('‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
            }
        }

        window.deleteUrl = function(id, event) {
            if (event) event.stopPropagation();
            if (confirm('‡¶Æ‡ßÅ‡¶õ‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) window.shortener.deleteUrl(id);
        }

        shortenBtn.addEventListener('click', async () => {
            const longUrl = longUrlInput.value.trim();
            if (!longUrl) {
                errorMessage.textContent = 'URL ‡¶¶‡¶ø‡¶®';
                errorMessage.classList.add('show');
                return;
            }

            if (adClickCount < 2) {
                openRandomAd();
                adClickCount++;
                adCounter.textContent = `${adClickCount + 1}/2`;
                
                if (adClickCount === 2) {
                    setTimeout(executeShorten, 500);
                }
            } else {
                executeShorten();
            }
        });

        async function executeShorten() {
            const longUrl = longUrlInput.value.trim();
            const customSlug = customSlugInput.value.trim();
            
            document.getElementById('btnText').style.display = 'none';
            document.getElementById('btnLoader').style.display = 'inline-block';
            errorMessage.classList.remove('show');

            try {
                await new Promise(r => setTimeout(r, 800));
                const newUrl = window.shortener.addUrl(longUrl, customSlug);
                
                document.getElementById('shortUrl').value = newUrl.shortUrl;
                document.getElementById('createdDate').textContent = "‡¶Ü‡¶ú";
                document.getElementById('clickCount').textContent = "0";
                document.getElementById('result').style.display = 'block';
                
                longUrlInput.value = '';
                customSlugInput.value = '';
                resetAdCounter();
                
            } catch (error) {
                errorMessage.textContent = error.message;
                errorMessage.classList.add('show');
            } finally {
                document.getElementById('btnText').style.display = 'inline';
                document.getElementById('btnLoader').style.display = 'none';
            }
        }

        document.getElementById('clearAll').addEventListener('click', (e) => {
            e.preventDefault();
            if(confirm('‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡¶¨‡ßá‡¶®?')) {
                localStorage.removeItem('shortened_urls_v2');
                location.reload();
            }
        });
        
        document.getElementById('copyBtn').addEventListener('click', () => {
            window.copyUrl(document.getElementById('shortUrl').value, {target: document.getElementById('copyBtn')});
        });
    </script>
</body>
</html>